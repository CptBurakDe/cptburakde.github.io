<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Burak Demirci â€“ Oceangoing Watchkeeping Officer</title>
<!-- replaced inline CSS with external stylesheet -->
<link rel="stylesheet" href="mycv.css">
<!-- html2pdf library for direct PDF generation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
</head>
<body class="theme-default">

<!-- Password protection modal -->
<div id="passwordModal" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:9999;display:flex;align-items:center;justify-content:center;">
  <div style="background:#fff;padding:40px;border-radius:8px;text-align:center;box-shadow:0 10px 40px rgba(0,0,0,0.3);max-width:400px;">
    <h2 style="margin-top:0;color:#0d1117;">ðŸ”’ Password Protected</h2>
    <p style="color:#666;margin:16px 0;">This CV is password protected. Please enter the password to continue.</p>
    <input type="password" id="pwInput" placeholder="Enter password" style="width:100%;padding:12px;border:1px solid #d0d7de;border-radius:6px;font-size:14px;box-sizing:border-box;margin-bottom:16px;">
    <button onclick="checkPassword()" style="width:100%;padding:12px;background:#0969da;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;">Unlock</button>
    <p id="pwError" style="color:#d1242f;font-size:12px;margin-top:12px;display:none;">Incorrect password. Please try again.</p>
  </div>
</div>

<!-- Greeting popup for company personalization -->
<div id="greetingModal" style="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:9998;display:none;align-items:center;justify-content:center;">
  <div style="background:#fff;padding:40px;border-radius:8px;text-align:center;box-shadow:0 10px 40px rgba(0,0,0,0.3);max-width:450px;">
    <img id="greetingLogo" src="" alt="Company Logo" style="width:80px;height:80px;object-fit:contain;margin:0 auto 16px;display:block;">
    <h2 id="greetingTitle" style="margin-top:0;color:#0d1117;"></h2>
    <p id="greetingText" style="color:#666;margin:16px 0;font-size:14px;"></p>
    <button onclick="closeGreeting()" style="padding:12px 24px;background:#0969da;color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;">Continue</button>
  </div>
</div>

<script>
// Password protection for mycv.html
(function(){
  const CORRECT_PASSWORD = 'IMRICH';
  const SESSION_KEY = 'mycv_unlocked';

  function checkPassword(){
    const input = document.getElementById('pwInput').value;
    const errorMsg = document.getElementById('pwError');
    const modal = document.getElementById('passwordModal');
    
    if(input === CORRECT_PASSWORD){
      sessionStorage.setItem(SESSION_KEY, 'true');
      modal.classList.remove('active');
      modal.style.display = 'none';
      errorMsg.style.display = 'none';
    } else {
      errorMsg.style.display = 'block';
      document.getElementById('pwInput').value = '';
    }
  }

  document.addEventListener('DOMContentLoaded', function(){
    const pwInput = document.getElementById('pwInput');
    const modal = document.getElementById('passwordModal');

    // If URL contains an 'id' parameter, skip password prompt entirely
    try {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has('id')) {
        // mark as unlocked for session and hide modal
        sessionStorage.setItem(SESSION_KEY, 'true');
        if (modal) {
          modal.classList.remove('active');
          modal.style.display = 'none';
        }
        if (pwInput) pwInput.blur();
        // expose checkPassword for console use if needed
        window.checkPassword = checkPassword;
        return;
      }
    } catch (e) {
      // ignore URL parsing errors and continue normal flow
      console.warn('URL parse error (password skip):', e);
    }

    // normal password behavior
    if(pwInput){
      pwInput.addEventListener('keypress', function(e){
        if(e.key === 'Enter') checkPassword();
      });
    }

    if(sessionStorage.getItem(SESSION_KEY)){
      if(modal){
        modal.classList.remove('active');
        modal.style.display = 'none';
      }
      if(pwInput) pwInput.blur();
    } else {
      if(modal){
        modal.classList.add('active');
        modal.style.display = 'flex';
      }
      if(pwInput) pwInput.focus();
    }
  });

  window.checkPassword = checkPassword;
})();

// Company personalization and greeting popup
window.closeGreeting = function(){
  const modal = document.getElementById('greetingModal');
  modal.style.display = 'none';
};

function getQueryParam(param) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(param);
}

function initializeCV(COMPANY_MAP) {
    try {
        const companyId = getQueryParam('id');
        
        // 1. Gerekli DOM elemanlarÄ±nÄ±n varlÄ±ÄŸÄ±nÄ± kontrol et
        const modal = document.getElementById('greetingModal');
        const logoEl = document.getElementById('greetingLogo');
        const titleEl = document.getElementById('greetingTitle');
        const textEl = document.getElementById('greetingText');
        
        // EÄŸer modal veya temel elemanlardan biri yoksa, devam etme (Hata Ã–nleme)
        if (!modal || !logoEl || !titleEl || !textEl) {
            console.error('Error: Required DOM elements (greetingModal, greetingLogo, etc.) not found.');
            // EÄŸer URL'de ID yoksa, bu durum normaldir (link oluÅŸturma modu)
            if (!companyId) return; 
            // EÄŸer ID varsa ama elementler yoksa, bu bir kurulum hatasÄ±dÄ±r.
            return;
        }

        // 2. Åžirket ID ve Harita KontrolÃ¼ (Link OluÅŸturma Modu)
        if (!companyId || !COMPANY_MAP || !COMPANY_MAP[companyId]) {
            console.warn('Company ID not found or invalid. Showing link creation interface.');
            // EÄŸer link oluÅŸturma arayÃ¼zÃ¼nÃ¼z varsa burada onu gÃ¶sterin (inputModal gibi)
            // Ã–rn: document.getElementById('inputModal').style.display = 'flex';
            return;
        }

        const company = COMPANY_MAP[companyId];

        // 3. Modal Ä°Ã§eriÄŸi (RolÃ¼nÃ¼ze Ã¶zel metin ve HTML kalÄ±nlaÅŸtÄ±rma)
        titleEl.textContent = `Welcome, This CV is Exclusively Prepared for ${company.name}!`;

        // Ä°Ã§erik iÃ§in innerHTML kullanÄ±yoruz
        textEl.innerHTML = `
            <p style="margin-bottom: 10px;">
                Thank you for taking the time to review this application. You are viewing a <strong>focused version</strong> of my CV, which has been specifically <strong>tailored to highlight</strong> how my experience as an <strong>Oceangoing Watchkeeping Officer</strong> directly aligns with <strong>${company.name}'s</strong> operational and strategic goals in maritime transportation. 
            </p>
            <p>
                I am eager to contribute my skills in safe navigation and efficient cargo operations, and look forward to discussing how I can add value to your team.
            </p>
        `;

        // 4. Logo ve GÃ¶rÃ¼nÃ¼rlÃ¼k
        if (company.logo) {
            logoEl.src = company.logo;
            logoEl.alt = `${company.name} Logo`;
        } else {
            // Logo yoksa varsayÄ±lanÄ± kullan
            logoEl.src = 'img/default-logo.png';
            logoEl.alt = 'Default Company Logo';
        }

        // Display modal
        modal.style.display = 'flex';
        modal.classList.add('active');

        // 5. Kapanma Ä°ÅŸleyicisi
        const closeModal = (e) => {
            // Modal iÃ§indeki iÃ§eriÄŸe veya butona tÄ±klamayÄ± engelle (sadece dÄ±ÅŸarÄ±ya tÄ±kla)
            if (e.target === modal || e.key === 'Escape') {
                modal.style.display = 'none';
                modal.classList.remove('active');
                // Ä°ÅŸleyiciyi kaldÄ±r
                document.removeEventListener('keydown', closeModal);
                modal.removeEventListener('click', closeModal);
            }
        };
        // Olay dinleyicilerini ekle (sadece bir kez)
        document.addEventListener('keydown', closeModal);
        modal.addEventListener('click', closeModal);

        // 6. Kariyer Hedefi BÃ¶lÃ¼mÃ¼nÃ¼ Enjekte Et
        // addCareerGoalSection'un daha Ã¶nce tanÄ±mlandÄ±ÄŸÄ±nÄ± varsayÄ±yoruz.
        addCareerGoalSection(company);

    } catch (err) {
        console.error('Error initializing CV (Fatal):', err);
    }
}

function addCareerGoalSection(company) {
  const profileSection = document.querySelector('.section-title');
  if (!profileSection) return;
  
  const rightColumn = document.querySelector('.right-column');
  const profileP = rightColumn.querySelector('p[style*="justify"]');
  
  if (profileP) {
    const careerSection = document.createElement('div');
    careerSection.style.marginTop = '10px';
    careerSection.innerHTML = `
      <div class="section-title">Career Goal</div>
      <div style="display:flex;gap:10px;align-items:center;font-size:10pt;margin-bottom:8px;">
        <img src="${company.logo}" alt="${company.name}" style="width:40px;height:40px;object-fit:contain;border-radius:4px;border:1px solid var(--border);">
        <div>
          <b>Target Company:</b> ${company.name}<br>
          <span style="color:var(--muted);font-size:9pt;">I am committed to leveraging my current OOW competencies to benefit your operations while actively seeking the professional development necessary to become a superior officer within this company.</span>
        </div>
      </div>
    `;
    profileP.parentNode.insertBefore(careerSection, profileP.nextSibling);
  }
}

// Fetch companies.json and initialize
document.addEventListener('DOMContentLoaded', function(){
  fetch('../companies.json')
    .then(response => response.json())
    .then(data => {
      initializeCV(data);
    })
    .catch(err => {
      console.warn('Could not load companies.json:', err);
    });
});
</script>

<!-- wrap to enable scaling to fit A4 height -->
<div class="cv-outer">
  <div class="cv-wrapper" id="cvWrap">
    <div class="cv-container" id="cv">
      <div class="left-column">
        <div class="profile-picture">
          <img src="../img/burakde.jpg" alt="Burak Demirci">
        </div>
        <div class="section-title">Contact</div>
        <div class="contact-info">
          <b>Email:</b> <a href="mailto:burak_de@yahoo.com">burak_de@yahoo.com</a><br>
          <b>Position:</b> Oceangoing Watchkeeping Officer<br>
          <b>Nationality:</b> Turkish<br>
          <b>DOB:</b> 09/11/2000<br>
          <b>Phone:</b> 
          <a href="tel:+905353450911" 
             onclick="copyPhone(event, '+90 (535) 345 09 11')">
            +90 (535) 345 09 11
          </a><br>
          <b>Marital Status:</b> Single<br>
          <b>Military Service:</b> Completed<br>
          <b>Adress:</b> Umraniye/ISTANBUL
        </div>

        <div class="section-title">Education</div>
        <div class="education-item">
          <b>Karadeniz Technical University</b><br>
          B.Sc. in Maritime Transportation & Management Eng.<br>
          2019â€“2023 | GPA: 3.50/4.00
        </div>
        <div class="education-item">
          <b>Istanbul Uskudar High School</b><br>
          High School Diploma | 2014â€“2018
        </div>

        <div class="section-title">Skills</div>
        <div class="skills">
          Bridge Team Management<br>
          Ship Handling & Navigation<br>
          Cargo & Ballast Operations<br>
          LSA/FFE Maintenance<br>
          Risk Assessment & Safety Audits<br>
          TRANSAS NS4000 ECDIS<br>
          GMDSS GOC, ARPA Radar Ops<br>
          Data Analysis, Handling, Automation (Python, SQL, Excel, VBA)<br>
          Passage Planning & Audit Preparation & SIRE Preparation
        </div>

        <div class="section-title">Certifications</div>
        <div class="cert-list" style="font-size: 0.9em; line-height: 1.3;">
          Security Familiarization â€¢ Security Awareness â€¢ Designated Security Duties â€¢ Advanced Fire Fighting â€¢ Fire Prevention & Fighting â€¢ Navigational Watchkeeping â€¢ Advanced Chemical Tanker Ops â€¢ Advanced Oil Tanker Ops â€¢ Basic Oil & Chemical Tanker Ops â€¢ Basic Liquefied Gas Tanker Ops â€¢ Medical Care â€¢ First Aid â€¢ Elementary First Aid â€¢ Fast Rescue Boats â€¢ Survival Craft & Rescue Boats â€¢ Personal Survival Techniques â€¢ Personal Safety & Social Responsibility
        </div>
        

        <div class="section-title">Languages</div>
        <div>English â€“ Professional Working Proficiency</div>

        <div class="section-title">Interests</div>
        <div class="interests">
          Maritime Safety<br>
          Navigation Systems<br>
          Data Science in Shipping<br>
          Cyber Security<br>
          Operational Leadership
        </div>
        
        <div class="section-title">Seafarer verification</div>
        <div class="qr-section">
          <div class="qr-box">
            <img src="https://api.qrserver.com/v1/create-qr-code/?size=75x75&data=https://gemiadami.uab.gov.tr/verification/67384263278/S00457983">
          </div>
        </div>
      </div>

      <div class="right-column">
        <div class="header">
          <h1>BURAK DEMIRCI</h1>
          <h2>OCEANGOING WATCHKEEPING OFFICER</h2>
        </div>

        <div class="section-title">Profile</div>
        <p style="font-size:10pt;text-align:justify;">
          An oceangoing Watchkeeping Officer 3-year experienced in tanker operations, navigation, and safety management on Aframax, LR, MR, and chemical/oil vessels. Participated numerous (300+) cargo operations and numerous flag state inspections, terminal vettings, and OCIMF SIRE 2.0. Competent in ECDIS (TRANSAS NS4000), Marflex / Framo Deepwell and Steam-turbined centrifugal pumps (Shinko), ballast treatment systems (AlfaLaval PureBallast), and LSA/FSS/ISM/ISPS Codes implementation. Focused on maintaining safety, environmental compliance, and operational efficiency under pressure. Skilled in coordinating with masters and chief officers, and implementing operational best practices.
        </p>

        <div class="section-title">Experience</div>

        <div class="experience-item">
          <div class="experience-header">
            <img src="../img/okanogullari.png" class="logo">
            <div class="duration" style="font-size:9pt;">Sep 2023 â€“ Oct 2025</div>
            <img src="../img/sebahatana.jpg" class="ship-photo">
          </div>
          <div class="company">Cilicia / OkanogullarÄ± Shipping â€“ M/T SEBAHAT ANA (8672.9 DWT)</div>
          <div class="title">Second Officer</div>
          <ul>
            <li>Bridge watchkeeping, navigation, and COLREG compliance.</li>
            <li>Numerous and various cargo operations, mooring (CBM, SBM).</li>
            <li>Maintained safety equipment, LSA/FFE.</li>
            <li>Participated in SIRE 2.0, Flag state, and Terminal Vettings inspections with positive outcomes.</li>
            <li>Prepared passage plans, risk assessments, and safety drills.</li>
            <li>Coordinated with masters and chief officers. ETC.</li>
          </ul>
        </div>

        <div class="experience-item">
          <div class="experience-header">
            <img src="../img/imza_marine_a_s_logo.jpg" class="logo">
            <div class="duration" style="font-size:9pt;">Mar 2022 â€“ Oct 2022</div>
            <img src="../img/bluminosa.jpg" class="ship-photo">
          </div>
          <div class="company">Imza Marine â€“ M/T B LUMINOSA (68,439 DWT)</div>
          <div class="title">Deck Cadet</div>
          <ul>
            <li>Assisted in shipboard operations including cargo and ballast control.</li>
            <li>Maintained safety and firefighting systems in compliance with SOLAS.</li>
            <li>Participated in mooring/unmooring operations under supervision.</li>
            <li>Recorded navigational and safety logs accurately during watch.</li>
            <li>Gained experience in STS operations and port maneuvers.</li>
          </ul>
        </div>

        <div class="experience-item">
          <div class="experience-header">
            <img src="../img/imza_marine_a_s_logo.jpg" class="logo">
            <div class="duration" style="font-size:9pt;">Jul 2021 â€“ Sep 2021</div>
            <img src="../img/coatlicue.jpg" class="ship-photo">
          </div>
          <div class="company">Imza Marine â€“ M/T COATLICUE (105,322 DWT)</div>
          <div class="title">Deck Cadet</div>
          <ul>
            <li>Assisted with crude oil washing, stripping, and pump-room checks.</li>
            <li>Performed navigational duties.</li>
            <li>Participated in onboard safety and emergency drills.</li>
            <li>Improved practical skills in cargo handling systems and operational safety.</li>
          </ul>
        </div>

        <div class="experience-item">
          <div class="experience-header">
            <img src="../img/aurora_shipping_llc_logo.jpg" class="logo">
            <div class="duration" style="font-size:9pt;">Jul 2020 â€“ Sep 2020</div>
            <img src="../img/trinity.jpg" class="ship-photo">
          </div>
          <div class="company">Aurora Shipping â€“ M/T TRIDENT TRINITY (45,467 DWT)</div>
          <div class="title">Deck Cadet</div>
          <ul>
            <li>Bridge watchkeeping and CCR Assisting</li>
            <li>Inerting, gas freeing, and ship-to-ship (STS) operations.</li>
            <li>Performed daily safety rounds and assisted with drills.</li>
            <li>Enhanced knowledge of Oil Product Tanker operations and safety compliance.</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="download-buttons">
  <button class="primary" onclick="window.print()">Download as PDF</button>

  <!-- Theme selector -->
  <div style="display:flex;gap:6px;align-items:center;">
    <button class="theme-button" data-theme="theme-default" title="Light / Default">Light</button>
    <button class="theme-button" data-theme="theme-blue" title="Blue tone">Blue</button>
    <button class="theme-button" data-theme="theme-dark" title="Dark">Dark</button>
  </div>
</div>

<script>
/* Updated script: reliable theme buttons + fitToA4 + copyPhone (preserves all behavior) */
(function(){
  // helpers kept (mmToPx and fitToA4 defined below)
  function mmToPx(mm){
    const el = document.createElement('div');
    el.style.height = mm + 'mm';
    el.style.position = 'absolute';
    el.style.left = '-9999px';
    document.body.appendChild(el);
    const px = el.getBoundingClientRect().height;
    document.body.removeChild(el);
    return px;
  }

  function fitToA4(){
    const wrap = document.getElementById('cvWrap');
    const cv = document.getElementById('cv');
    if(!wrap || !cv) return;
    const targetPx = mmToPx(297) - mmToPx(20);
    wrap.style.transform = 'none';
    const actual = cv.getBoundingClientRect().height;
    let scale = 1;
    if(actual > targetPx){
      scale = targetPx / actual;
      scale = Math.max(scale, 0.60);
    }
    document.documentElement.style.setProperty('--scale', scale);
    wrap.style.transform = 'scale(' + scale + ')';
  }

  // copyPhone preserved
  window.copyPhone = function(event, number){
    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
    if(!isMobile){
      event.preventDefault();
      if(navigator.clipboard && navigator.clipboard.writeText){
        navigator.clipboard.writeText(number).then(() => {
          const prev = document.getElementById('copynotice'); if(prev) prev.remove();
          const n = document.createElement('div');
          n.id = 'copynotice';
          n.textContent = 'Phone number copied to clipboard';
          Object.assign(n.style,{position:'fixed',right:'16px',bottom:'16px',background:'rgba(0,0,0,0.7)',color:'#fff',padding:'8px 12px',borderRadius:'6px',zIndex:9999});
          document.body.appendChild(n);
          setTimeout(()=> n.remove(), 2200);
        }).catch(err => console.error('Failed to copy phone:', err));
      } else {
        alert('Phone number: ' + number);
      }
    }
  };

  // Auto-download PDF if download=true parameter present (no print dialog)
  function checkAutoDownload(){
    try {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('download') === 'true') {
        // Get company ID for filename
        const companyId = urlParams.get('id') || 'CV';
        const fileName = `Burak Demirci-CV-${companyId}.pdf`;
        
        // Wait for CV to render, then generate PDF
        setTimeout(() => {
          const cvElement = document.getElementById('cv');
          if (!cvElement) {
            console.error('CV element not found');
            return;
          }
          
          // html2pdf options
          const opt = {
            margin: 10,
            filename: fileName,
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2, useCORS: true },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
          };
          
          // Generate and download PDF
          html2pdf().set(opt).from(cvElement).save();
        }, 800);
      }
    } catch (e) {
      console.warn('Auto-download check error:', e);
    }
  }

  // Theme wiring on DOM ready
  document.addEventListener('DOMContentLoaded', function(){
    const THEMES = ['theme-default','theme-blue','theme-dark'];
    const themeButtons = Array.from(document.querySelectorAll('.theme-button'));

    function applyTheme(theme){
      if(!THEMES.includes(theme)) theme = 'theme-default';
      document.body.classList.remove(...THEMES);
      document.body.classList.add(theme);
      try{ localStorage.setItem('cv_theme', theme); } catch(e){}
      themeButtons.forEach(b => b.classList.toggle('active', b.dataset.theme === theme));
    }

    // init
    const saved = (function(){ try{return localStorage.getItem('cv_theme');}catch(e){return null;} })() || 'theme-default';
    applyTheme(saved);

    // attach
    themeButtons.forEach(btn => {
      btn.addEventListener('click', function(e){
        const t = this.dataset.theme || 'theme-default';
        applyTheme(t);
        setTimeout(fitToA4, 60);
      });
    });

    // initial fit
    setTimeout(fitToA4, 80);

    // bind global events
    window.addEventListener('resize', () => setTimeout(fitToA4, 120));
    window.addEventListener('beforeprint', () => setTimeout(fitToA4, 40));
    window.addEventListener('keydown', (e) => {
      if(e.altKey && !e.shiftKey){
        if(e.key === '1') applyTheme('theme-default');
        if(e.key === '2') applyTheme('theme-blue');
        if(e.key === '3') applyTheme('theme-dark');
        setTimeout(fitToA4, 60);
      }
    });

    // Check for auto-download parameter
    checkAutoDownload();
  });
})();
</script>

</body>
</html>

